% TODO: 100samples/1=0.01
\begin{tikzpicture}[line width=0.5pt, scale=(\textwidth-20pt)/8.4cm, >=Latex]

    \newcommand{\polytwo}{\ca+\cb*((\x-\ta)/(\tb-\ta))+\cc*((\x-\ta)/(\tb-\ta))^2}
    \newcommand{\polythree}{\ca+\cb*((\x-\ta)/(\tb-\ta))+\cc*((\x-\ta)/(\tb-\ta))^2+\cd*((\x-\ta)/(\tb-\ta))^3}
    \newcommand{\polyfour}{\ca+\cb*((\x-\ta)/(\tb-\ta))+\cc*((\x-\ta)/(\tb-\ta))^2+\cd*((\x-\ta)/(\tb-\ta))^3+\ce*((\x-\ta)/(\tb-\ta))^4}

	% grid
	%\draw[help lines, color=gray!30, dashed] (-4,-3) grid (4,4);
	
	% frame
	\draw (-4.2,-3.2) rectangle (4.2,4.2);
	% \draw[help lines] (-4,0) -- (4,0);
	% \draw[help lines] (0,-3) -- (0,4);
	% \draw[->, thick] (-4.06,0) -- (4,0) node[right] {$t/\zeta$};
	% \draw[->, thick] (-4,-3) -- (-4,4) node[above] {$x$};

	% grid and ticks
	\foreach \y in {-3.0,-2.0,-1.0,0.0,1.0,2.0,3.0,4.0} {
		\draw[help lines, color=gray!30, dashed] (-4.2,\y) -- (4.2,\y);
		\draw[thick] (-4.2,\y) -- (-4.08,\y);
		\draw[thick] (4.2,\y) -- (4.08,\y);
	}
	\foreach \x in {-4.0,-3.25,-2.0,-1.2,0.0,0.75,2.0,2.8,4.0} {
		\draw[help lines, color=gray!30, dashed] (\x,-3.2) -- (\x,4.2);
		\draw[thick] (\x,4.2) -- (\x,4.08);
		\draw[thick] (\x,-3.2) -- (\x,-3.08);
	}

	\draw (-4.0,4.1)   node[below] {$t_0$};
	\draw (-3.25,4.1)  node[below] {$t_1$};
	\draw (-2.0,4.1)   node[below] {$t_2$};
	\draw (-1.2,4.1)   node[below] {$t_3$};
	\draw (0.0,4.1)    node[below] {$t_4$};
	\draw (0.0,-3.1)   node[above] {$\hat t_0$};
	\draw (0.75,-3.1)  node[above] {$\hat t_1$};
	\draw (2.0,-3.1)   node[above] {$\hat t_2$};
	\draw (2.8,-3.1)   node[above] {$\hat t_3$};
	\draw (4.0,-3.1)   node[above] {$\hat t_4$};
	
	% \draw (-4,-0.3) node[below] {$-T$};
	\draw (-4.1,0.0) node[right] {$0$};

	% \draw (0.5,0) node[below] {$\hat t_1$};
	% \draw[thick] (0.5,-0.06) -- (0.5,0.06);
	% \draw (1,0) node[below] {$\hat t_2$};
	% \draw[thick] (1,-0.06) -- (1,0.06);
	% \draw (2,0) node[below] {$\hat t_3$};
	% \draw[thick] (2,-0.06) -- (2,0.06);
	% \draw (2.5,0) node[below] {$\hat t_4$};
	% \draw[thick] (2.5,-0.06) -- (2.5,0.06);
	% \draw (3,0) node[below] {$\hat t_5$};
	% \draw[thick] (3,-0.06) -- (3,0.06);
	% \draw (4,0) node[below] {$\hat t_6$};
	% \draw (4,-0.3) node[below] {$r$};
	% \draw[thick] (4,-0.06) -- (4,0.06);
	%\draw[thick] (\x,-0.06) -- (\x,0.06);
	

	% initial condition

	% on [-4,-3.25]
	\newcommand{\ta}{-4}
	\newcommand{\tb}{-3.25}
	\newcommand{\ca}{1.3}
	\newcommand{\cb}{1.7}
	\newcommand{\cc}{-5.3}
	\newcommand{\cd}{2.8}
	\draw[curve,cadlag] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polythree});
	% \filldraw[leftpoint] (-4,1.3) circle (0.04);
	% \filldraw[rightpoint] (-3.25,0.5) circle (0.04);

	% on [-3.25,-2]
	\renewcommand{\ta}{-3.25}
	\renewcommand{\tb}{-2.0}
	\renewcommand{\ca}{-0.2}
	\renewcommand{\cb}{-1.125}
	\renewcommand{\cc}{4.35}
	\renewcommand{\cd}{-2.125}
	\draw[curve,cadlag] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polythree});
	% \filldraw[leftpoint] (-3.25,-0.2) circle (0.04);
	% \filldraw[rightpoint] (-2,0.9) circle (0.04);
	
	% on [-2,-1.2]
	\renewcommand{\ta}{-2.0}
	\renewcommand{\tb}{-1.2}
	\renewcommand{\ca}{0.4}
	\renewcommand{\cb}{-0.24}
	\renewcommand{\cc}{-0.32}
	\renewcommand{\cd}{0.96}
	\draw[curve,leftp] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polythree});
	% \filldraw[leftpoint] (-2,0.4) circle (0.04);

	
	% on [-1.2,0]
	\renewcommand{\ta}{-1.2}
	\renewcommand{\tb}{0.0}
	\renewcommand{\ca}{0.8}
	\renewcommand{\cb}{0.2}
	\renewcommand{\cc}{-4.72}
	\renewcommand{\cd}{2.92}
	\draw[curve,cadlag] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polythree});
	% \filldraw[leftpoint] (-1.2,0.8) circle (0.04);
	% \filldraw[rightpoint] (0,-0.7) circle (0.04);


	% solution of x'=-x(t-4)
	% \filldraw[leftpoint] (0.0,1.5) circle (0.04);


	% on [0,0.75]
	\renewcommand{\ta}{0.0}
	\renewcommand{\tb}{0.75}
	\renewcommand{\ca}{1.5}
	\renewcommand{\cb}{-1.3}
	\renewcommand{\cc}{-0.85}
	\renewcommand{\cd}{1.7666666666666}
	\newcommand{\ce}{-0.7}
	\draw[curve,leftp] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polyfour});

	% on [0.75,2.0]
	\renewcommand{\ta}{0.75}
	\renewcommand{\tb}{2.0}
	\renewcommand{\ca}{0.4166666666666}
	\renewcommand{\cb}{0.2}
	\renewcommand{\cc}{0.5625}
	\renewcommand{\cd}{-1.45}
	\renewcommand{\ce}{0.53125}
	\draw[curve] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polyfour});

	% on [2.0,2.8]
	\renewcommand{\ta}{2.0}
	\renewcommand{\tb}{2.8}
	\renewcommand{\ca}{0.2604166666666}
	\renewcommand{\cb}{-0.4}
	\renewcommand{\cc}{0.12}
	\renewcommand{\cd}{0.106666666666666}
	\renewcommand{\ce}{-0.24}
	\draw[curve] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polyfour});

	% on [2.8,4]
	\renewcommand{\ta}{2.8}
	\renewcommand{\tb}{4.0}
	\renewcommand{\ca}{-0.152916666666}
	\renewcommand{\cb}{-0.8}
	\renewcommand{\cc}{-0.1}
	\renewcommand{\cd}{1.573333333333333}
	\renewcommand{\ce}{-0.73}
	\draw[curve] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polyfour});


    % derivative of initial condition

    % on [-4.0,-3.25]
    \renewcommand{\ta}{-4.0}
    \renewcommand{\tb}{-3.25}
    \renewcommand{\ca}{1.7}
    \renewcommand{\cb}{-10.6}
    \renewcommand{\cc}{8.4}
    \draw[deriv,cadlag] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polytwo});

    % on [-3.25,-2]
    \renewcommand{\ta}{-3.25}
    \renewcommand{\tb}{-2.0}
    \renewcommand{\ca}{-1.125}
    \renewcommand{\cb}{8.7}
    \renewcommand{\cc}{-6.375}
    \draw[deriv,cadlag] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polytwo});

    % on [-2,-1.2]
    \renewcommand{\ta}{-2.0}
    \renewcommand{\tb}{-1.2}
    \renewcommand{\ca}{-0.24}
    \renewcommand{\cb}{-0.64}
    \renewcommand{\cc}{2.88}
    \draw[deriv,cadlag] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polytwo});

    % on [-1.2,0]
    \renewcommand{\ta}{-1.2}
    \renewcommand{\tb}{0.0}
    \renewcommand{\ca}{0.2}
    \renewcommand{\cb}{-9.44}
    \renewcommand{\cc}{8.76}
    \draw[deriv,cadlag] plot[samples=50, smooth, domain=\ta:\tb] (\x, {\polytwo});

	% term value
    \draw[term,cadlag] (0.0,2.8074) -- (0.01,2.7652) -- (0.02,2.7227) -- (0.03,2.6801) -- (0.04,2.6374) -- (0.05,2.5947) -- (0.06,2.5521) -- (0.07,2.5097) -- (0.08,2.4675) -- (0.09,2.4256) -- (0.1,2.384) -- (0.11,2.3429) -- (0.12,2.3023) -- (0.13,2.2623) -- (0.14,2.2229) -- (0.15,2.1842) -- (0.16,2.1464) -- (0.17,2.1094) -- (0.18,2.0733) -- (0.19,2.0382) -- (0.2,2.0041) -- (0.21,1.9712) -- (0.22,1.9395) -- (0.23,1.909) -- (0.24,1.8798);

    \draw[term,cadlag] (0.25,1.1521) -- (0.26,1.1231) -- (0.27,1.0951) -- (0.28,1.068) -- (0.29,1.0418) -- (0.3,1.0166) -- (0.31,0.9924) -- (0.32,0.9691) -- (0.33,0.9469) -- (0.34,0.9257) -- (0.35,0.9055) -- (0.36,0.8863) -- (0.37,0.8682) -- (0.38,0.8511) -- (0.39,0.8351) -- (0.4,0.8202) -- (0.41,0.8064) -- (0.42,0.7937) -- (0.43,0.7821) -- (0.44,0.7715) -- (0.45,0.7621) -- (0.46,0.7539) -- (0.47,0.7467) -- (0.48,0.7407) -- (0.49,0.7358) -- (0.5,0.7321) -- (0.51,0.7295) -- (0.52,0.7281) -- (0.53,0.7278) -- (0.54,0.7287) -- (0.55,0.7307) -- (0.56,0.7339) -- (0.57,0.7382) -- (0.58,0.7437) -- (0.59,0.7504) -- (0.6,0.7582) -- (0.61,0.7672) -- (0.62,0.7773) -- (0.63,0.7885) -- (0.64,0.8009) -- (0.65,0.8145) -- (0.66,0.8292) -- (0.67,0.845) -- (0.68,0.8619) -- (0.69,0.88) -- (0.7,0.8991) -- (0.71,0.9194) -- (0.72,0.9408) -- (0.73,0.9633) -- (0.74,0.9868);
    
    \draw[term,cadlag] (0.75,1.0114) -- (0.76,1.0454) -- (0.77,1.0804) -- (0.78,1.1164) -- (0.79,1.1535);
    
    \draw[term,cadlag] (0.8,1.1916) -- (0.81,1.2067) -- (0.82,1.2214) -- (0.83,1.2358) -- (0.84,1.2496) -- (0.85,1.2631) -- (0.86,1.2762) -- (0.87,1.2889) -- (0.88,1.3011) -- (0.89,1.313) -- (0.9,1.3244) -- (0.91,1.3354) -- (0.92,1.346) -- (0.93,1.3562) -- (0.94,1.366) -- (0.95,1.3754) -- (0.96,1.3844) -- (0.97,1.3929) -- (0.98,1.4011) -- (0.99,1.4088) -- (1.0,1.4162) -- (1.01,1.4231) -- (1.02,1.4296) -- (1.03,1.4357) -- (1.04,1.4414) -- (1.05,1.4467) -- (1.06,1.4516) -- (1.07,1.4561) -- (1.08,1.4601) -- (1.09,1.4638) -- (1.1,1.4671) -- (1.11,1.47) -- (1.12,1.4724) -- (1.13,1.4745) -- (1.14,1.4762) -- (1.15,1.4775) -- (1.16,1.4783) -- (1.17,1.4788) -- (1.18,1.4789) -- (1.19,1.4786) -- (1.2,1.4779) -- (1.21,1.4769) -- (1.22,1.4754) -- (1.23,1.4736) -- (1.24,1.4713) -- (1.25,1.4687) -- (1.26,1.4657) -- (1.27,1.4623) -- (1.28,1.4586) -- (1.29,1.4544) -- (1.3,1.4499) -- (1.31,1.4451) -- (1.32,1.4398) -- (1.33,1.4342) -- (1.34,1.4282) -- (1.35,1.4219) -- (1.36,1.4152) -- (1.37,1.4081) -- (1.38,1.4007) -- (1.39,1.393) -- (1.4,1.3849) -- (1.41,1.3764) -- (1.42,1.3676) -- (1.43,1.3584) -- (1.44,1.3489) -- (1.45,1.3391) -- (1.46,1.3289) -- (1.47,1.3184) -- (1.48,1.3076) -- (1.49,1.2965);
    
    \draw[term,cadlag] (1.5,0.785) -- (1.51,0.7607) -- (1.52,0.7362) -- (1.53,0.7116) -- (1.54,0.687) -- (1.55,0.6622) -- (1.56,0.6374) -- (1.57,0.6126) -- (1.58,0.5877) -- (1.59,0.5629) -- (1.6,0.538) -- (1.61,0.5133) -- (1.62,0.4886) -- (1.63,0.464) -- (1.64,0.4395) -- (1.65,0.4151) -- (1.66,0.3909) -- (1.67,0.3669) -- (1.68,0.3431) -- (1.69,0.3195) -- (1.7,0.2962) -- (1.71,0.2731) -- (1.72,0.2503) -- (1.73,0.2278) -- (1.74,0.2057) -- (1.75,0.1839) -- (1.76,0.1624) -- (1.77,0.1414) -- (1.78,0.1208) -- (1.79,0.1007) -- (1.8,0.081) -- (1.81,0.0618) -- (1.82,0.0431) -- (1.83,0.0249) -- (1.84,0.0073) -- (1.85,-0.0097) -- (1.86,-0.0261) -- (1.87,-0.0419) -- (1.88,-0.0571) -- (1.89,-0.0716) -- (1.9,-0.0854) -- (1.91,-0.0985) -- (1.92,-0.1108) -- (1.93,-0.1224) -- (1.94,-0.1332) -- (1.95,-0.1432) -- (1.96,-0.1523) -- (1.97,-0.1606) -- (1.98,-0.1681) -- (1.99,-0.1746);
    
    \draw[term,cadlag] (2.0,2.1198) -- (2.01,2.1036) -- (2.02,2.0877) -- (2.03,2.072) -- (2.04,2.0567) -- (2.05,2.0417) -- (2.06,2.027) -- (2.07,2.0128) -- (2.08,1.9991) -- (2.09,1.9858) -- (2.1,1.973) -- (2.11,1.9607) -- (2.12,1.949) -- (2.13,1.938) -- (2.14,1.9275) -- (2.15,1.9177) -- (2.16,1.9086) -- (2.17,1.9002) -- (2.18,1.8926) -- (2.19,1.8857) -- (2.2,1.8796) -- (2.21,1.8743) -- (2.22,1.8699) -- (2.23,1.8663) -- (2.24,1.8637) -- (2.25,1.8619) -- (2.26,1.861) -- (2.27,1.8611) -- (2.28,1.8622) -- (2.29,1.8643);
    
    \draw[term,cadlag] (2.3,1.8673) -- (2.31,1.8473) -- (2.32,1.827) -- (2.33,1.8062) -- (2.34,1.785) -- (2.35,1.7634) -- (2.36,1.7415) -- (2.37,1.7193) -- (2.38,1.6967) -- (2.39,1.6738) -- (2.4,1.6506) -- (2.41,1.6271) -- (2.42,1.6033) -- (2.43,1.5792) -- (2.44,1.5548) -- (2.45,1.5302) -- (2.46,1.5053) -- (2.47,1.4801) -- (2.48,1.4547) -- (2.49,1.4291) -- (2.5,1.4032) -- (2.51,1.3771) -- (2.52,1.3507) -- (2.53,1.3241) -- (2.54,1.2973) -- (2.55,1.2702) -- (2.56,1.2429) -- (2.57,1.2154) -- (2.58,1.1876) -- (2.59,1.1597) -- (2.6,1.1314) -- (2.61,1.1029) -- (2.62,1.0742) -- (2.63,1.0452) -- (2.64,1.016) -- (2.65,0.9865) -- (2.66,0.9568) -- (2.67,0.9267) -- (2.68,0.8964) -- (2.69,0.8658) -- (2.7,0.8348) -- (2.71,0.8036) -- (2.72,0.772) -- (2.73,0.7401) -- (2.74,0.7079);
    
    \draw[term,cadlag] (2.75,0.6753) -- (2.76,0.6506) -- (2.77,0.6254) -- (2.78,0.5999) -- (2.79,0.574); 
    
    \draw[term,cadlag] (2.8,0.5477) -- (2.81,0.5244) -- (2.82,0.5011) -- (2.83,0.4776) -- (2.84,0.4541) -- (2.85,0.4305) -- (2.86,0.4069) -- (2.87,0.3832) -- (2.88,0.3595) -- (2.89,0.3357) -- (2.9,0.312) -- (2.91,0.2882) -- (2.92,0.2645) -- (2.93,0.2408) -- (2.94,0.2171) -- (2.95,0.1934) -- (2.96,0.1698) -- (2.97,0.1463) -- (2.98,0.1229) -- (2.99,0.0995) -- (3.0,0.0763) -- (3.01,0.0531) -- (3.02,0.0301) -- (3.03,0.0072) -- (3.04,-0.0155) -- (3.05,-0.0381) -- (3.06,-0.0606) -- (3.07,-0.0828) -- (3.08,-0.1049) -- (3.09,-0.1268) -- (3.1,-0.1485) -- (3.11,-0.17) -- (3.12,-0.1912) -- (3.13,-0.2122) -- (3.14,-0.233) -- (3.15,-0.2534) -- (3.16,-0.2737) -- (3.17,-0.2936) -- (3.18,-0.3133) -- (3.19,-0.3327) -- (3.2,-0.3517) -- (3.21,-0.3705) -- (3.22,-0.3889) -- (3.23,-0.4069) -- (3.24,-0.4247) -- (3.25,-0.442) -- (3.26,-0.459) -- (3.27,-0.4757) -- (3.28,-0.4919) -- (3.29,-0.5077) -- (3.3,-0.5231) -- (3.31,-0.5381) -- (3.32,-0.5527) -- (3.33,-0.5669) -- (3.34,-0.5806) -- (3.35,-0.5938) -- (3.36,-0.6066) -- (3.37,-0.6189) -- (3.38,-0.6307) -- (3.39,-0.642) -- (3.4,-0.6528) -- (3.41,-0.6631) -- (3.42,-0.6728) -- (3.43,-0.6821) -- (3.44,-0.6908) -- (3.45,-0.6989) -- (3.46,-0.7065) -- (3.47,-0.7135) -- (3.48,-0.7199) -- (3.49,-0.7258);
    
    \draw[term,cadlag] (3.5,1.569) -- (3.51,1.5506) -- (3.52,1.532) -- (3.53,1.5131) -- (3.54,1.4941) -- (3.55,1.4749) -- (3.56,1.4556) -- (3.57,1.4361) -- (3.58,1.4166) -- (3.59,1.3969) -- (3.6,1.3772) -- (3.61,1.3575) -- (3.62,1.3377) -- (3.63,1.318) -- (3.64,1.2982) -- (3.65,1.2785) -- (3.66,1.2588) -- (3.67,1.2391) -- (3.68,1.2196) -- (3.69,1.2001) -- (3.7,1.1807) -- (3.71,1.1615) -- (3.72,1.1424) -- (3.73,1.1234) -- (3.74,1.1045) -- (3.75,1.0858) -- (3.76,1.0673) -- (3.77,1.049) -- (3.78,1.0309) -- (3.79,1.0129) -- (3.8,0.9952) -- (3.81,0.9777) -- (3.82,0.9604) -- (3.83,0.9433) -- (3.84,0.9265) -- (3.85,0.9099) -- (3.86,0.8936) -- (3.87,0.8775) -- (3.88,0.8616) -- (3.89,0.846) -- (3.9,0.8307) -- (3.91,0.8156) -- (3.92,0.8008) -- (3.93,0.7862) -- (3.94,0.7719) -- (3.95,0.7579) -- (3.96,0.7441) -- (3.97,0.7306) -- (3.98,0.7173) -- (3.99,0.7043);


\end{tikzpicture}
